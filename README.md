#######################################################################################

＃免责声明：此脚本仅做学习与技术交流，请勿用于任何商业用途，请勿利用此插件进行任何违法活动

＃使用此脚本所造成的一切损失和后果与本人无关，转载注明出处　　　　　　　　　　　　　　　　　

#######################################################################################

getThePicturesFrombanciyuan #爬取半次元的绘画以及cos的图片#

#####################################

#使用此脚本可以从半次元网站爬取大量的图片#

#####################################

运行此脚本需要node.js环境

第一步

获取半次元的异步请求链接

文件index.js里已经包含了两个链接，有一定的可能性不可用

如果不可用那就自己获取

下面讲解获取方法（此操作需登录，不登录获取的链接不可用）：

打开浏览器进入半次元官网，进入cos板块（如要获取绘画区的图操作一致），按F12打开控制台，进入控制台Network板块

滑动半次元页面至底部，此时页面会发送异步请求数据，在控制台Network板块可以很轻松的找到链接

它的格式为https://bcy.net/apiv3/common/getFeeds?refer=channel&direction=loadmore&cid=xxxxxxxxxx&_signature=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


将这个链接复制粘贴到index.js的requestUrl中保存

第二步

打开powershall，进入脚本的根目录，执行脚本，命令为node index 为保证脚本的正常执行，在执行脚本后在脚本没有提示下载完成也没有大量报错前请勿做任何操作

便会自动在脚本根目录下生成download文件夹，并将图片分类放置

#########

#参数讲解#

#########

在index.js中除requestUrl外有3个可调动参数，这三个参数可控制爬取得数据量，爬取的速度，但调节这三个参数到一定程度之后可能导致服务器拒绝请求导致下载中断或失败

aimCount 接受一个整数，用以控制请求的次数，次数越多数据越多，但是不要超过100，因为半次元不会一次提供这么多的数据，设置参数过高也会导致下载请求巨大， 需要调整另两个参数，否则半次元会单方面切断连接导致下载失败。

maxConnectNum 接受一个整数，控制下载任务的并发数，推荐15以下，当aimCount较少的情况下也可适当提升数值

downloadDelay 接受一个整数，代表毫秒，为了防止短时间内大量的请求导致服务器拒绝请求，该插件将下载任务分为最大值为maxConnectNum的多个批次

当完成一个批次的下载后，会进行一次短时间的延迟，延迟过后再下载下一批次的任务，该值代表延迟，这个值越大被服务器屏蔽的可能性越小推荐100以上数值

总结：后面两个数值要根据第一个数值调整，以求不被服务器屏蔽的情况，下面列出几个下载成功的参数设置供参考

aimCount:10 maxConnectNum:25 downloadDelay:150

aimCount:30 maxConnectNum:8 downloadDelay:300

ainCount:100 maxConnectNum:5 downloadDelay:600

以上参数不代表绝对，根据自身网络状况等确定